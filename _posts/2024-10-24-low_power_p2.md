---
layout: post
title: "UPF低功耗实现系列博客——2 UPF电源网络编码"
date:   2024-10-24
tags: [low power]
comments: true
author: Shuhao
---

## Supply Port 介绍

定义：电源/地网络的”**逻辑源头**“，即电源网络在不同范围的连接点。（物理上不存在对应的物理端口）

命令及可选项：

```tcl
create_supply_port port_name
    [-domain domain_name]
    [-direction <in | out | inout>]
```
- port Name：通常与同一范围内的电源网络相同
- domain：该端口所在的电源域定义了一个电源网络连接点。
- direction：in/out/inout，代表电流的方向；工具应遵循Liberty中为PG端口指定的方向；通常在UPF中将电源端口定义为“inout”或“input”
    - power switch向scope外的单元供电：output
    - 同时给同一scope供电：inout
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="../images/image-20230629142404090.png" width = "65%" alt=""/>
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
        Supply Port
  	</div>
</center>


## Supply Net 介绍

定义：硬件描述语言（HDL）对电源轨的表示。

- 明确设计中使用的电源网络；**所有PG网络都应在UPF中定义。**
- 此命令中未定义功能和电压。
- 每个电源网络都应连接到其端口或层级电源端口。

命令及可选项：

```tcl
create_supply_net net_name
    [-domain domain_name][-reuse]
    [-resolve <unresolved | one_hot | parallel | parallel_one_hot |resolution_ function_name >]
```

- net_name：来源于spec。
- domain：定义电源网络的作用域所在的电源域。
- reuse：电源网络将在另一个同名范围内使用。（少用）
- resolve：定义当供电网络由一个或多个电源开关驱动时，如何解析供电网络的状态和电压。（对实现没什么用，simulation可能有用）
    - unresolved：电源网络最多只能连接一个电源源。这是默认设置。
    - one_hot：多个电源源可以连接到电源网络，但任何时刻只能有一个源驱动网络，否则状态不确定。
    - parallel：多个电源源共享一个根电源驱动器，可以并联连接。如果所有源都是FULL_ON，网络状态为FULL_ON；如果有源是OFF且有源是FULL_ON或PARTIAL_ON，网络状态为PARTIAL_ON。
    - parallel_one_hot：多个电源源可以连接到电源网络，每个源可以有多个路径连接到网络。任何时刻最多只有一个根电源驱动器是FULL_ON，其他源使用parallel解析。

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="../images/image-20230629145648323.png" width = "65%" alt=""/>
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
        Supply Net
  	</div>
</center>

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="../images/image-20230629150226500.png" width = "65%" alt=""/>
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
        Supply Net Resolve Option
  	</div>
</center>

## Supply Set 介绍

定义：一组电源功能的集合，整体上提供一个完整的电源。

- 一组给某个单元供电的相关的 power/ground/nwell/pwell/deeplnwell/deeppwell nets
- UPF 2.0 的语法，UPF 1.0不支持


## UPF 电源网络编码示例


